# **[长城杯 2021 政企组]魔鬼凯撒的RC4茶室**

---

## 考点

---

**#UPX #动调 #凯撒 #XOR**

----

## 思路

---

![[长城杯 2021 政企组]魔鬼凯撒的RC4茶室_1](./images/%5B长城杯 2021 政企组%5D魔鬼凯撒的RC4茶室_1.png)

发现了程序有upx壳，先去壳再进行分析

![[长城杯 2021 政企组]魔鬼凯撒的RC4茶室_2](./images/%5B长城杯 2021 政企组%5D魔鬼凯撒的RC4茶室_2.png)

看到主函数开头先输入一个字符串然后经过加密再与已知字符串进行对比

![[长城杯 2021 政企组]魔鬼凯撒的RC4茶室_3](./images/%5B长城杯 2021 政企组%5D魔鬼凯撒的RC4茶室_3.png)

可知开头输入的账号，所以先来看开头的这个加密账号的加密函数

![[长城杯 2021 政企组]魔鬼凯撒的RC4茶室_4](./images/%5B长城杯 2021 政企组%5D魔鬼凯撒的RC4茶室_4.png)

这个加密函数是凯撒加密，由主函数的参数可以得到字母移位了20，而数字则是移位了8，再由密文z8layn_b91_nb9ha1}，可以得到f0rget_h13_th1ng3}为账号

![[长城杯 2021 政企组]魔鬼凯撒的RC4茶室_5](./images/%5B长城杯 2021 政企组%5D魔鬼凯撒的RC4茶室_5.png)

可知后半段flag确实是正确的，然后输入账号之后是一个加解密程序，但是这个解密程序用不了，发现程序中根本没有解密函数，只有加密函数sub_2401FD

![[长城杯 2021 政企组]魔鬼凯撒的RC4茶室_6](./images/%5B长城杯 2021 政企组%5D魔鬼凯撒的RC4茶室_6.png)

于是查看加密函数，发现加密的逻辑非常简单就是异或

![[长城杯 2021 政企组]魔鬼凯撒的RC4茶室_7](./images/%5B长城杯 2021 政企组%5D魔鬼凯撒的RC4茶室_7.png)

再通过动调在上图加密逻辑这里下断点程序会运行到这里，然后查看这个异或的值就能得到下图为异或操作的密钥

![[长城杯 2021 政企组]魔鬼凯撒的RC4茶室_8](./images/%5B长城杯 2021 政企组%5D魔鬼凯撒的RC4茶室_8.png)

然后再根据附件得到的加密后的flag文件，反推得到前半段flag的值flag{x1aom1ng_1s_3o_easy_